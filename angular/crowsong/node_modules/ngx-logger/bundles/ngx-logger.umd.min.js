!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("@angular/common/http"),require("rxjs/operators"),require("vlq"),require("rxjs")):"function"==typeof define&&define.amd?define("ngx-logger",["exports","@angular/common","@angular/core","@angular/common/http","rxjs/operators","vlq","rxjs"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ngx-logger"]={},e.ng.common,e.ng.core,e.ng.common.http,e.rxjs.operators,e.vlq,e.rxjs)}(this,(function(e,t,r,o,n,i,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */Object.create;function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}function s(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}Object.create;var c,l=function(){function e(e){this.httpBackend=e}return e.prototype.logOnServer=function(e,t,r){var i=new o.HttpRequest("POST",e,t,r||{});return this.httpBackend.handle(i).pipe(n.filter((function(e){return e instanceof o.HttpResponse})),n.map((function(e){return e.body})))},e}();l.decorators=[{type:r.Injectable}],l.ctorParameters=function(){return[{type:o.HttpBackend}]},(c=e.NgxLoggerLevel||(e.NgxLoggerLevel={}))[c.TRACE=0]="TRACE",c[c.DEBUG=1]="DEBUG",c[c.INFO=2]="INFO",c[c.LOG=3]="LOG",c[c.WARN=4]="WARN",c[c.ERROR=5]="ERROR",c[c.FATAL=6]="FATAL",c[c.OFF=7]="OFF";var u=function(){},p=function(){function e(e){this.config=e,this._config=e}return Object.defineProperty(e.prototype,"level",{get:function(){return this._config.level},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverLogLevel",{get:function(){return this._config.serverLogLevel},enumerable:!1,configurable:!0}),e.prototype.updateConfig=function(e){this._config=this._clone(e)},e.prototype.getConfig=function(){return this._clone(this._config)},e.prototype._clone=function(e){var t=new u;return Object.keys(e).forEach((function(r){t[r]=e[r]})),t},e}(),f=["purple","teal","gray","gray","red","red","red"],h=function(){function t(){}return t.prepareMetaString=function(e,t,r,o){return e+" "+t+(r?" ["+r+":"+o+"]":"")},t.getColor=function(t,r){switch(t){case e.NgxLoggerLevel.TRACE:return this.getColorFromConfig(e.NgxLoggerLevel.TRACE,r);case e.NgxLoggerLevel.DEBUG:return this.getColorFromConfig(e.NgxLoggerLevel.DEBUG,r);case e.NgxLoggerLevel.INFO:return this.getColorFromConfig(e.NgxLoggerLevel.INFO,r);case e.NgxLoggerLevel.LOG:return this.getColorFromConfig(e.NgxLoggerLevel.LOG,r);case e.NgxLoggerLevel.WARN:return this.getColorFromConfig(e.NgxLoggerLevel.WARN,r);case e.NgxLoggerLevel.ERROR:return this.getColorFromConfig(e.NgxLoggerLevel.ERROR,r);case e.NgxLoggerLevel.FATAL:return this.getColorFromConfig(e.NgxLoggerLevel.FATAL,r);case e.NgxLoggerLevel.OFF:default:return}},t.getColorFromConfig=function(e,t){return t?t[e]:f[e]},t.prepareMessage=function(e){try{"string"==typeof e||e instanceof Error||(e=JSON.stringify(e,null,2))}catch(t){e='The provided "message" value could not be parsed with JSON.stringify().'}return e},t.prepareAdditionalParameters=function(e){return null==e?null:e.map((function(e,t){try{return"object"==typeof e&&JSON.stringify(e),e}catch(e){return"The additional["+t+"] value could not be parsed using JSON.stringify()."}}))},t}(),v=function(){function e(e,t,r){this.fileName=e,this.lineNumber=t,this.columnNumber=r}return e.prototype.toString=function(){return this.fileName+":"+this.lineNumber+":"+this.columnNumber},e}(),L=function(){function e(e){this.httpBackend=e,this.sourceMapCache=new Map,this.logPositionCache=new Map}return e.getStackLine=function(e){var t=new Error;try{throw t}catch(o){try{var r=4;return t.stack.split("\n")[0].includes(".js:")||(r+=1),t.stack.split("\n")[r+(e||0)]}catch(e){return null}}},e.getPosition=function(e){var t=e.lastIndexOf("/"),r=e.indexOf(")");r<0&&(r=void 0);var o=e.substring(t+1,r).split(":");return 3===o.length?new v(o[0],+o[1],+o[2]):new v("unknown",0,0)},e.getTranspileLocation=function(e){var t=e.indexOf("(");t<0&&(t=e.lastIndexOf("@"))<0&&(t=e.lastIndexOf(" "));var r=e.indexOf(")");return r<0&&(r=void 0),e.substring(t+1,r)},e.getMapFilePath=function(t){var r=e.getTranspileLocation(t),o=r.substring(0,r.lastIndexOf(":"));return o.substring(0,o.lastIndexOf(":"))+".map"},e.getMapping=function(e,t){for(var r=0,o=0,n=0,a=e.mappings.split(";"),g=0;g<a.length;g++)for(var s=0,c=a[g].split(","),l=0;l<c.length;l++){var u=i.decode(c[l]);if(u.length>=4&&(s+=u[0],r+=u[1],o+=u[2],n+=u[3]),g===t.lineNumber){if(s===t.columnNumber)return new v(e.sources[r],o,n);if(l+1===c.length)return new v(e.sources[r],o,0)}}return new v("unknown",0,0)},e.prototype._getSourceMap=function(t,r){var i=new o.HttpRequest("GET",t),g=r.toString();if(this.logPositionCache.has(g))return this.logPositionCache.get(g);this.sourceMapCache.has(t)||this.sourceMapCache.set(t,this.httpBackend.handle(i).pipe(n.filter((function(e){return e instanceof o.HttpResponse})),n.map((function(e){return e.body})),n.retry(3),n.shareReplay(1)));var s=this.sourceMapCache.get(t).pipe(n.map((function(t){return e.getMapping(t,r)})),n.catchError((function(){return a.of(r)})),n.shareReplay(1));return this.logPositionCache.set(g,s),s},e.prototype.getCallerDetails=function(t,r){var o=this,i=e.getStackLine(r);return i?a.of([e.getPosition(i),e.getMapFilePath(i)]).pipe(n.switchMap((function(e){var r=g(e,2),n=r[0],i=r[1];return t?o._getSourceMap(i,n):a.of(n)}))):a.of(new v("",0,0))},e}();L.decorators=[{type:r.Injectable}],L.ctorParameters=function(){return[{type:o.HttpBackend}]};var d=["TRACE","DEBUG","INFO","LOG","WARN","ERROR","FATAL","OFF"],m=function(){function r(e,r,o,n,i){this.mapperService=e,this.httpService=r,this.platformId=n,this.datePipe=i,this._withCredentials=!1,this._isIE=t.isPlatformBrowser(n)&&navigator&&navigator.userAgent&&!(-1===navigator.userAgent.indexOf("MSIE")&&!navigator.userAgent.match(/Trident\//)&&!navigator.userAgent.match(/Edge\//)),this.config=new p(o),this._logFunc=this._isIE?this._logIE.bind(this):this._logModern.bind(this)}return Object.defineProperty(r.prototype,"level",{get:function(){return this.config.level},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"serverLogLevel",{get:function(){return this.config.serverLogLevel},enumerable:!1,configurable:!0}),r.prototype.trace=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._log(e.NgxLoggerLevel.TRACE,t,r)},r.prototype.debug=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._log(e.NgxLoggerLevel.DEBUG,t,r)},r.prototype.info=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._log(e.NgxLoggerLevel.INFO,t,r)},r.prototype.log=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._log(e.NgxLoggerLevel.LOG,t,r)},r.prototype.warn=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._log(e.NgxLoggerLevel.WARN,t,r)},r.prototype.error=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._log(e.NgxLoggerLevel.ERROR,t,r)},r.prototype.fatal=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];this._log(e.NgxLoggerLevel.FATAL,t,r)},r.prototype.setCustomHttpHeaders=function(e){this._customHttpHeaders=e},r.prototype.setCustomParams=function(e){this._customParams=e},r.prototype.setWithCredentialsOptionValue=function(e){this._withCredentials=e},r.prototype.registerMonitor=function(e){this._loggerMonitor=e},r.prototype.updateConfig=function(e){this.config.updateConfig(e)},r.prototype.getConfigSnapshot=function(){return this.config.getConfig()},r.prototype._logIE=function(t,r,o,n){switch(n=n||[],t){case e.NgxLoggerLevel.WARN:console.warn.apply(console,s([r+" ",o],n));break;case e.NgxLoggerLevel.ERROR:case e.NgxLoggerLevel.FATAL:console.error.apply(console,s([r+" ",o],n));break;case e.NgxLoggerLevel.INFO:console.info.apply(console,s([r+" ",o],n));break;default:console.log.apply(console,s([r+" ",o],n))}},r.prototype._logModern=function(t,r,o,n){var i=this.getConfigSnapshot().colorScheme,a=h.getColor(t,i);switch(n=n||[],t){case e.NgxLoggerLevel.WARN:console.warn.apply(console,s(["%c"+r,"color:"+a,o],n));break;case e.NgxLoggerLevel.ERROR:case e.NgxLoggerLevel.FATAL:console.error.apply(console,s(["%c"+r,"color:"+a,o],n));break;case e.NgxLoggerLevel.INFO:console.info.apply(console,s(["%c"+r,"color:"+a,o],n));break;case e.NgxLoggerLevel.DEBUG:console.debug.apply(console,s(["%c"+r,"color:"+a,o],n));break;default:console.log.apply(console,s(["%c"+r,"color:"+a,o],n))}},r.prototype._log=function(t,r,n,i){var a=this;void 0===n&&(n=[]),void 0===i&&(i=!0);var g=this.config.getConfig(),s=i&&g.serverLoggingUrl&&t>=g.serverLogLevel,c=t>=g.level;if(r&&(s||c)){var l=d[t];r="function"==typeof r?r():r;var u=h.prepareAdditionalParameters(n),p=g.timestampFormat?this.datePipe.transform(new Date,g.timestampFormat):(new Date).toISOString();this.mapperService.getCallerDetails(g.enableSourceMaps,g.proxiedSteps).subscribe((function(i){var f={message:h.prepareMessage(r),additional:u,level:t,timestamp:p,fileName:i.fileName,lineNumber:i.lineNumber.toString()};if(a._loggerMonitor&&c&&a._loggerMonitor.onLog(f),s){f.message=r instanceof Error?r.stack:r,f.message=h.prepareMessage(f.message);var v=a._customHttpHeaders||new o.HttpHeaders;v.set("Content-Type","application/json");var L={headers:v,params:a._customParams||new o.HttpParams,responseType:g.httpResponseType||"json",withCredentials:a._withCredentials};a.httpService.logOnServer(g.serverLoggingUrl,f,L).subscribe((function(e){}),(function(t){a._log(e.NgxLoggerLevel.ERROR,"FAILED TO LOG ON SERVER: "+r,[t],!1)}))}if(c&&!g.disableConsoleLogging){var d=h.prepareMetaString(p,l,g.disableFileDetails?null:i.fileName,i.lineNumber.toString());return a._logFunc(t,d,r,n)}}))}},r}();m.decorators=[{type:r.Injectable}],m.ctorParameters=function(){return[{type:L},{type:l},{type:u},{type:void 0,decorators:[{type:r.Inject,args:[r.PLATFORM_ID]}]},{type:t.DatePipe}]};var y=function(){function e(e,t,r,o){this.mapperService=e,this.httpService=t,this.platformId=r,this.datePipe=o}return e.prototype.create=function(e,t,r,o){var n=new m(o||this.mapperService,t||this.httpService,e,this.platformId,this.datePipe);return r&&n.registerMonitor(r),n},e}();y.decorators=[{type:r.Injectable}],y.ctorParameters=function(){return[{type:L},{type:l},{type:void 0,decorators:[{type:r.Inject,args:[r.PLATFORM_ID]}]},{type:t.DatePipe}]};var N=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:u,useValue:t||{}},m,l,y,L]}},e.forChild=function(){return{ngModule:e,providers:[m,l,y,L]}},e}();N.decorators=[{type:r.NgModule,args:[{imports:[t.CommonModule],providers:[m,l,y,L,t.DatePipe]}]}];var b=function(){},O=function(){};e.CustomNGXLoggerService=y,e.DEFAULT_COLOR_SCHEME=f,e.Levels=d,e.LoggerConfig=u,e.LoggerModule=N,e.NGXLogInterface=O,e.NGXLogger=m,e.NGXLoggerHttpService=l,e.NGXLoggerMonitor=b,e.NGXLoggerUtils=h,e.NGXMapperService=L,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-logger.umd.min.js.map